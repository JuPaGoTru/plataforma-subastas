{% extends 'base.html' %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header text-center">
                <h2>Subasta Programada</h2>
            </div>
            <div class="card-body text-center">
                <img src="{{ product.image.url }}" class="img-fluid rounded mb-4" alt="{{ product.name }}" style="max-height: 300px;">
                
                <h3>{{ product.name }}</h3>
                <p class="lead">{{ product.description }}</p>
                
                <div class="alert alert-info">
                <h4>⏰ Esta subasta comenzará en:</h4>
                <p class="display-6">{{ time_until_start }}</p>
                <p class="mb-0">
                    <strong>Inicio:</strong> <span id="start_time">{{ product.start_time|date:"c" }}</span><br>
                    <strong>Fin:</strong> <span id="end_time">{{ product.end_time|date:"c" }}</span>
                </p>
                </div>
                
                <div class="row text-center">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5>Precio Inicial</h5>
                                <p class="h3">${{ product.starting_price }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5>Estado</h5>
                                <p class="h3"><span class="badge bg-warning">Programada</span></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <a href="{% url 'index' %}" class="btn btn-primary">Volver a subastas</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function formatLocalDateTime(isoString) {
    const date = new Date(isoString);
    if (isNaN(date)) {
        return "Fecha inválida";
    }
    const options = { 
        year: 'numeric', month: 'long', day: 'numeric',
        hour: '2-digit', minute: '2-digit', second: '2-digit'
    };
    return date.toLocaleString(undefined, options);
    }

document.addEventListener('DOMContentLoaded', function() {
    const startElem = document.getElementById('start_time');
    const endElem = document.getElementById('end_time');

    if (startElem) {
    const startUTC = startElem.textContent;
    startElem.textContent = formatLocalDateTime(startUTC);
    }

    if (endElem) {
    const endUTC = endElem.textContent;
    endElem.textContent = formatLocalDateTime(endUTC);
    }
});
</script>
{% endblock %}